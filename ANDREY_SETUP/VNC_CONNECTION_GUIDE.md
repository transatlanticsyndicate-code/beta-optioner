# üñ•Ô∏è –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ prod —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ VNC –∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ TWS

**–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω—É–∂–Ω–∞ –∫–æ–≥–¥–∞ TWS –∑–∞–≤–∏—Å–∞–µ—Ç –∏–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è.**

---

## üéØ –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

- ‚úÖ –ü–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ TWS –µ—Å–ª–∏ —Å–µ—Å—Å–∏—è –ø–æ—Ç–µ—Ä—è–Ω–∞
- ‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å TWS –µ—Å–ª–∏ –æ–Ω –∑–∞–≤–∏—Å–∞–µ—Ç
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å TWS –≤–∏–∑—É–∞–ª—å–Ω–æ
- ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ä—É—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

1. **SSH –∫–ª—é—á** ‚Äî `~/.ssh/id_optioner` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å)
2. **VNC –∫–ª–∏–µ–Ω—Ç** ‚Äî —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
3. **–î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç** ‚Äî –¥–ª—è SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ VNC –∫–ª–∏–µ–Ω—Ç–∞

#### macOS
```bash
# –ß–µ—Ä–µ–∑ Homebrew
brew install vnc-viewer

# –ò–ª–∏ —Å–∫–∞—á–∞—Ç—å: https://www.realvnc.com/download/viewer/
```

#### Linux
```bash
sudo apt-get install tigervnc-viewer
# –∏–ª–∏
sudo apt-get install vncviewer
```

#### Windows
–°–∫–∞—á–∞—Ç—å: https://www.realvnc.com/download/viewer/

---

## üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å SSH —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è VNC

```bash
ssh -i ~/.ssh/id_optioner -L 5900:127.0.0.1:5900 -N root@89.117.52.143
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- `-L 5900:127.0.0.1:5900` ‚Äî –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ—Ä—Ç 5900 (VNC)
- `-N` ‚Äî –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ–º shell
- –¢—É–Ω–Ω–µ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º –≤ —ç—Ç–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç—É–Ω–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç:**
```bash
# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
lsof -i :5900
```

–î–æ–ª–∂–µ–Ω —É–≤–∏–¥–µ—Ç—å:
```
COMMAND   PID  USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME
ssh     53181 levon    5u  IPv6 0xad12ff0156f7a580      0t0  TCP localhost:rfb (LISTEN)
```

### –®–∞–≥ 2: –û—Ç–∫—Ä—ã—Ç—å VNC –∫–ª–∏–µ–Ω—Ç

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É (macOS/Linux)
```bash
# macOS
open vnc://127.0.0.1:5900

# Linux
vncviewer 127.0.0.1:5900
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ GUI
1. –û—Ç–∫—Ä—ã—Ç—å VNC Viewer –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –í –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –≤–≤–µ—Å—Ç–∏: `127.0.0.1:5900`
3. –ù–∞–∂–∞—Ç—å Enter

### –®–∞–≥ 3: –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ VNC

**–ü–∞—Ä–æ–ª—å VNC:** `9556017`

1. –ü–æ—è–≤–∏—Ç—Å—è –æ–∫–Ω–æ —Å –∑–∞–ø—Ä–æ—Å–æ–º –ø–∞—Ä–æ–ª—è
2. –í–≤–µ—Å—Ç–∏: `9556017`
3. –ù–∞–∂–∞—Ç—å OK

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª —Å–µ—Ä–≤–µ—Ä–∞ —Å TWS

---

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ TWS

### –ï—Å–ª–∏ TWS —É–∂–µ –∑–∞–ø—É—â–µ–Ω

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ TWS –æ–∫–Ω–æ –≤–∏–¥–Ω–æ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
2. –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚Äî –≤–≤–µ—Å—Ç–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
   - **Username:** `bogda6172`
   - **Password:** `19642014angel`

### –ï—Å–ª–∏ TWS –Ω–µ –∑–∞–ø—É—â–µ–Ω

1. –û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Ctrl+Alt+T –∏–ª–∏ —á–µ—Ä–µ–∑ –º–µ–Ω—é)
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å TWS:
   ```bash
   cd /opt/ibgateway
   ./ibgateway
   ```
3. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤—ã—à–µ

### –ï—Å–ª–∏ TWS –∑–∞–≤–∏—Å–∞–µ—Ç

1. –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å TWS:
   ```bash
   ps aux | grep -i gateway
   ```

2. –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å:
   ```bash
   pkill -f ibgateway
   ```

3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ:
   ```bash
   cd /opt/ibgateway
   ./ibgateway
   ```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

### –í VNC –æ–∫–Ω–µ

1. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–Ω–æ –æ–∫–Ω–æ TWS/IB Gateway
2. –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "Connected" –∏–ª–∏ "Ready"
3. –ï—Å–ª–∏ –≤–∏–¥–Ω–æ —Ñ–æ—Ä–º—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî –∑–Ω–∞—á–∏—Ç –Ω—É–∂–Ω–∞ –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã:
```bash
python query_es_contracts_simple.py
```

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –∑–Ω–∞—á–∏—Ç TWS –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ ‚úÖ

---

## üîÑ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –¢–µ—Ä–º–∏–Ω–∞–ª 1: SSH —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è TWS API
```bash
ssh -i ~/.ssh/id_optioner -L 4002:127.0.0.1:4002 -N root@89.117.52.143
```

### –¢–µ—Ä–º–∏–Ω–∞–ª 2: SSH —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è VNC
```bash
ssh -i ~/.ssh/id_optioner -L 5900:127.0.0.1:5900 -N root@89.117.52.143
```

### –¢–µ—Ä–º–∏–Ω–∞–ª 3: VNC –∫–ª–∏–µ–Ω—Ç
```bash
vncviewer 127.0.0.1:5900
# –í–≤–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å: 9556017
```

### –¢–µ—Ä–º–∏–Ω–∞–ª 4: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã
```bash
python query_es_contracts_simple.py
```

---

## ‚ö†Ô∏è Troubleshooting

### –û—à–∏–±–∫–∞: "Connection refused"
```
vncviewer: unable to connect to socket: Connection refused
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ SSH —Ç—É–Ω–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç: `lsof -i :5900`
2. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –æ—Ç–∫—Ä—ã—Ç—å –∑–∞–Ω–æ–≤–æ
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω: `ping 89.117.52.143`

### –û—à–∏–±–∫–∞: "Authentication failed"
```
VNC authentication failed
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å: `9556017`
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ VNC —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø—Ä–æ–¥–µ
3. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

### –û—à–∏–±–∫–∞: "Connection timed out"
```
ssh: connect to host 89.117.52.143 port 22: Operation timed out
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
3. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ

### VNC –æ–∫–Ω–æ —á—ë—Ä–Ω–æ–µ
```
–í–∏–¥–Ω–æ —Ç–æ–ª—å–∫–æ —á—ë—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ–¥–æ–∂–¥–∞—Ç—å 5-10 —Å–µ–∫—É–Ω–¥ (—Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è)
2. –ù–∞–∂–∞—Ç—å –º—ã—à–∫–æ–π –Ω–∞ —ç–∫—Ä–∞–Ω
3. –ù–∞–∂–∞—Ç—å Ctrl+Alt+T —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª

### TWS –Ω–µ –≤–∏–¥–Ω–æ –≤ VNC
```
–ù–µ—Ç –æ–∫–Ω–∞ TWS –Ω–∞ —ç–∫—Ä–∞–Ω–µ
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª (Ctrl+Alt+T)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å: `ps aux | grep -i gateway`
3. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å: `cd /opt/ibgateway && ./ibgateway`

---

## üìå –í–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **SSH Host** | 89.117.52.143 |
| **SSH Port** | 22 |
| **SSH Key** | ~/.ssh/id_optioner |
| **VNC Port** | 5900 |
| **VNC Password** | 9556017 |
| **TWS Port** | 4002 |
| **IB Username** | bogda6172 |
| **IB Password** | 19642014angel |

---

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VNC

### –ò—Å–ø–æ–ª—å–∑—É–π VNC –∫–æ–≥–¥–∞:
- ‚úÖ TWS –∑–∞–≤–∏—Å–∞–µ—Ç –∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ API –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –ù—É–∂–Ω–æ –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ TWS
- ‚úÖ –ù—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å TWS
- ‚úÖ –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤–∏–∑—É–∞–ª—å–Ω–æ
- ‚úÖ –ù—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä—É—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –ù–µ –Ω—É–∂–µ–Ω VNC –∫–æ–≥–¥–∞:
- ‚ùå –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—à—å —Å–∫—Ä–∏–ø—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É–π SSH —Ç—É–Ω–Ω–µ–ª—å –Ω–∞ –ø–æ—Ä—Ç 4002)
- ‚ùå –•–æ—á–µ—à—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ API (–∏—Å–ø–æ–ª—å–∑—É–π ib_insync)

---

## üí° –°–æ–≤–µ—Ç—ã

1. **–î–µ—Ä–∂–∏ –æ–±–∞ —Ç—É–Ω–Ω–µ–ª—è –æ—Ç–∫—Ä—ã—Ç—ã–º–∏** ‚Äî –æ–¥–∏–Ω –¥–ª—è TWS API (4002), –æ–¥–∏–Ω –¥–ª—è VNC (5900)
2. **–ò—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω–∞–ª—ã** ‚Äî –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç—É–Ω–Ω–µ–ª—è —Å–≤–æ–π
3. **–ü—Ä–æ–≤–µ—Ä—è–π —Å—Ç–∞—Ç—É—Å** ‚Äî `lsof -i :4002` –∏ `lsof -i :5900`
4. **–ó–∞–∫—Ä—ã–≤–∞–π —Ç—É–Ω–Ω–µ–ª–∏** ‚Äî `pkill -f 'ssh.*4002'` –∏ `pkill -f 'ssh.*5900'`

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ TWS: `../–ò–ù–°–¢–†–£–ö–¶–ò–Ø_IB_GATEWAY.md`
- –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤: `../query_es_contracts_simple.py`
- –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è ES –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤: `../ES_CONTRACTS_SPECIFICATION.md`

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 18 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–ª—è:** –õ–µ–≤–æ–Ω –∏ –ê–Ω–¥—Ä–µ–π
