# üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ TWS API –¥–ª—è –ê–Ω–¥—Ä–µ—è (clientId=102)

**–≠—Ç—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –ê–Ω–¥—Ä–µ—é, —á—Ç–æ–±—ã –µ–≥–æ –ò–ò –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–∏–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.**

---

## –¶–µ–ª—å

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É –ê–Ω–¥—Ä–µ—è –ª–æ–∫–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ TWS API –Ω–∞ –ø—Ä–æ–¥–µ —á–µ—Ä–µ–∑ SSH-—Ç—É–Ω–Ω–µ–ª—å –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ê–Ω–¥—Ä–µ—è

- **Client ID:** 102
- **SSH —Å–µ—Ä–≤–µ—Ä:** root@89.117.52.143
- **SSH –∫–ª—é—á:** `~/.ssh/id_optioner` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ –º–∞—à–∏–Ω–µ –ê–Ω–¥—Ä–µ—è)
- **–õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç:** 4002 (—Ç—É–Ω–Ω–µ–ª—å –Ω–∞ prod TWS)

---

## –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –∫–ª—é—á–∞

–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —É –ê–Ω–¥—Ä–µ—è –µ—Å—Ç—å SSH –∫–ª—é—á –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ø—Ä–æ–¥—É:

```bash
ls -la ~/.ssh/id_optioner
```

–ï—Å–ª–∏ –∫–ª—é—á–∞ –Ω–µ—Ç ‚Äî –∑–∞–ø—Ä–æ—Å–∏ –µ–≥–æ —É –õ–µ–≤–æ–Ω–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–∏:

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á
nano ~/.ssh/id_optioner
# –í—Å—Ç–∞–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–ª—é—á–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å (Ctrl+X, Y, Enter)

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
chmod 600 ~/.ssh/id_optioner
```

---

## –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

### 2.1. –°–æ–∑–¥–∞—Ç—å `.env` —Ñ–∞–π–ª –¥–ª—è TWS

**–ü—É—Ç—å:** `backend/.env.tws_local` (–∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `.env`)

```bash
# TWS API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ê–Ω–¥—Ä–µ–π)
TWS_HOST=127.0.0.1
TWS_PORT=4002
TWS_CLIENT_ID=102

# –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
# –ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ—Ç–∫—Ä–æ–π SSH —Ç—É–Ω–Ω–µ–ª—å:
# ssh -i ~/.ssh/id_optioner -L 4002:127.0.0.1:4002 -N root@89.117.52.143
```

### 2.2. –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è SSH

**–ü—É—Ç—å:** `__Levon_tasks/IB/workingTWS/connect_to_prod_tws_andrey.sh`

```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è SSH —Ç—É–Ω–Ω–µ–ª—è –∫ prod TWS (–ê–Ω–¥—Ä–µ–π, clientId=102)

echo "üîå –ü–æ–¥–∫–ª—é—á–∞—é—Å—å –∫ prod TWS —á–µ—Ä–µ–∑ SSH tunnel..."
echo "üì° –°–µ—Ä–≤–µ—Ä: 89.117.52.143"
echo "üîê –ö–ª—é—á: ~/.ssh/id_optioner"
echo "üö™ –ü–æ—Ä—Ç: 4002 -> 4002"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ—Ä—Ç –Ω–µ –∑–∞–Ω—è—Ç
if lsof -Pi :4002 -sTCP:LISTEN -t >/dev/null ; then
    echo "‚ö†Ô∏è  –ü–æ—Ä—Ç 4002 —É–∂–µ –∑–∞–Ω—è—Ç. –í–æ–∑–º–æ–∂–Ω–æ —Ç—É–Ω–Ω–µ–ª—å —É–∂–µ –æ—Ç–∫—Ä—ã—Ç."
    echo "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: lsof -i :4002"
    echo "–£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å: pkill -f 'ssh.*4002'"
    exit 1
fi

# –û—Ç–∫—Ä—ã—Ç—å —Ç—É–Ω–Ω–µ–ª—å
ssh -i ~/.ssh/id_optioner \
    -L 4002:127.0.0.1:4002 \
    -N \
    root@89.117.52.143 &

SSH_PID=$!

sleep 2

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç—É–Ω–Ω–µ–ª—å –æ—Ç–∫—Ä—ã–ª—Å—è
if lsof -Pi :4002 -sTCP:LISTEN -t >/dev/null ; then
    echo "‚úÖ –¢—É–Ω–Ω–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫—Ä—ã—Ç (PID: $SSH_PID)"
    echo "‚úÖ TWS API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ localhost:4002"
    echo ""
    echo "–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å:"
    echo "  ‚Ä¢ –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã —Å ib_insync"
    echo "  ‚Ä¢ –†–∞–±–æ—Ç–∞—Ç—å –≤ Jupyter notebooks"
    echo "  ‚Ä¢ –ü–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ TWS —Å clientId=102"
    echo ""
    echo "–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç—É–Ω–Ω–µ–ª—è:"
    echo "  pkill -f 'ssh.*4002'"
    echo "  –∏–ª–∏: kill $SSH_PID"
else
    echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å —Ç—É–Ω–Ω–µ–ª—å"
    echo "–ü—Ä–æ–≤–µ—Ä—å:"
    echo "  1. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ (ping 89.117.52.143)"
    echo "  2. SSH –∫–ª—é—á (~/.ssh/id_optioner)"
    echo "  3. –ü—Ä–∞–≤–∞ –Ω–∞ –∫–ª—é—á (chmod 600 ~/.ssh/id_optioner)"
    exit 1
fi
```

–°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
```bash
chmod +x __Levon_tasks/IB/workingTWS/connect_to_prod_tws_andrey.sh
```

### 2.3. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

**–ü—É—Ç—å:** `__Levon_tasks/IB/workingTWS/test_tws_connection_andrey.py`

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ TWS —á–µ—Ä–µ–∑ SSH —Ç—É–Ω–Ω–µ–ª—å (–ê–Ω–¥—Ä–µ–π, clientId=102)

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
1. –û—Ç–∫—Ä—ã—Ç—å SSH —Ç—É–Ω–Ω–µ–ª—å: ./connect_to_prod_tws_andrey.sh
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç: python test_tws_connection_andrey.py
"""

from ib_insync import IB, Stock
import os
from datetime import datetime

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN = "\033[92m"
RED = "\033[91m"
YELLOW = "\033[93m"
BLUE = "\033[94m"
RESET = "\033[0m"


def print_section(title):
    print(f"\n{BLUE}{'=' * 80}{RESET}")
    print(f"{BLUE}{title.center(80)}{RESET}")
    print(f"{BLUE}{'=' * 80}{RESET}\n")


def test_connection():
    """–¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"""
    print_section("–¢–ï–°–¢ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ TWS")
    
    ib = IB()
    
    try:
        print("–ü–æ–¥–∫–ª—é—á–∞—é—Å—å –∫ TWS...")
        ib.connect('127.0.0.1', 4002, clientId=102, timeout=10)
        
        print(f"{GREEN}‚úì –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!{RESET}")
        print(f"  Host: 127.0.0.1:4002")
        print(f"  Client ID: {ib.client.clientId}")
        print(f"  –í—Ä–µ–º—è: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        
        return ib, True
        
    except Exception as e:
        print(f"{RED}‚úó –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: {e}{RESET}")
        print(f"\n{YELLOW}–ü—Ä–æ–≤–µ—Ä—å:{RESET}")
        print("  1. SSH —Ç—É–Ω–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç? (lsof -i :4002)")
        print("  2. TWS –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø—Ä–æ–¥–µ?")
        return None, False


def test_market_data(ib):
    """–¢–µ—Å—Ç 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    print_section("–¢–ï–°–¢ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (SPY)")
    
    try:
        # –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç SPY
        spy = Stock('SPY', 'SMART', 'USD')
        ib.qualifyContracts(spy)
        
        print(f"–ö–æ–Ω—Ç—Ä–∞–∫—Ç: {spy.symbol} ({spy.exchange})")
        
        # –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        ticker = ib.reqMktData(spy, '', False, False, [])
        ib.sleep(2)  # –ü–æ–¥–æ–∂–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
        
        print(f"{GREEN}‚úì –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã:{RESET}")
        print(f"  Bid: ${ticker.bid if ticker.bid and ticker.bid > 0 else 'N/A'}")
        print(f"  Ask: ${ticker.ask if ticker.ask and ticker.ask > 0 else 'N/A'}")
        print(f"  Last: ${ticker.last if ticker.last and ticker.last > 0 else 'N/A'}")
        print(f"  Volume: {ticker.volume if ticker.volume else 0}")
        print(f"  Market Data Type: {ticker.marketDataType} (1=real-time, 2=frozen, 3=delayed)")
        
        # –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
        ib.cancelMktData(spy)
        
        return True
        
    except Exception as e:
        print(f"{RED}‚úó –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: {e}{RESET}")
        return False


def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print(f"\n{GREEN}{'=' * 80}{RESET}")
    print(f"{GREEN}–¢–ï–°–¢ –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –ö TWS API (–ê–Ω–¥—Ä–µ–π, clientId=102){RESET}")
    print(f"{GREEN}{'=' * 80}{RESET}")
    
    # –¢–µ—Å—Ç 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
    ib, connected = test_connection()
    
    if not connected:
        print(f"\n{RED}‚ùå –¢–ï–°–¢–´ –ü–†–ï–†–í–ê–ù–´: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è{RESET}\n")
        return
    
    # –¢–µ—Å—Ç 2: –†—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    data_ok = test_market_data(ib)
    
    # –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è
    print_section("–û—Ç–∫–ª—é—á–µ–Ω–∏–µ")
    ib.disconnect()
    print(f"{GREEN}‚úì –û—Ç–∫–ª—é—á–µ–Ω –æ—Ç TWS{RESET}")
    
    # –ò—Ç–æ–≥–∏
    print_section("–†–ï–ó–£–õ–¨–¢–ê–¢–´")
    
    if data_ok:
        print(f"\n{GREEN}‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´! –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.{RESET}")
        print(f"\n{BLUE}–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å:{RESET}")
        print("  ‚Ä¢ –†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã —Å ib_insync –ª–æ–∫–∞–ª—å–Ω–æ")
        print("  ‚Ä¢ –†–∞–±–æ—Ç–∞—Ç—å –≤ Jupyter notebooks")
        print("  ‚Ä¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏")
    else:
        print(f"\n{YELLOW}‚ö†Ô∏è  –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ—à—ë–ª. –ü—Ä–æ–≤–µ—Ä—å –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.{RESET}")
    
    print(f"\n{BLUE}{'=' * 80}{RESET}\n")


if __name__ == "__main__":
    main()
```

–°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
```bash
chmod +x __Levon_tasks/IB/workingTWS/test_tws_connection_andrey.py
```

---

## –®–∞–≥ 3: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### 3.1. –û—Ç–∫—Ä—ã—Ç—å SSH —Ç—É–Ω–Ω–µ–ª—å

```bash
cd __Levon_tasks/IB/workingTWS
./connect_to_prod_tws_andrey.sh
```

–î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –≤—ã–≤–æ–¥:
```
‚úÖ –¢—É–Ω–Ω–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫—Ä—ã—Ç (PID: XXXXX)
‚úÖ TWS API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ localhost:4002
```

### 3.2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

```bash
python test_tws_connection_andrey.py
```

–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, —É–≤–∏–¥–∏—à—å:
```
‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´! –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
```

---

## –®–∞–≥ 4: –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `my_test.py`:

```python
from ib_insync import IB, Stock
import os
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ .env
load_dotenv('backend/.env.tws_local')

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ TWS
ib = IB()
ib.connect(
    os.getenv('TWS_HOST', '127.0.0.1'),
    int(os.getenv('TWS_PORT', 4002)),
    clientId=int(os.getenv('TWS_CLIENT_ID', 102))
)

print(f"‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω! ClientId: {ib.client.clientId}")

# –ü—Ä–∏–º–µ—Ä: –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É SPY
spy = Stock('SPY', 'SMART', 'USD')
ib.qualifyContracts(spy)
ticker = ib.reqMktData(spy)
ib.sleep(2)

print(f"SPY: bid={ticker.bid}, ask={ticker.ask}")

# –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è
ib.disconnect()
```

---

## –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

### ‚úÖ –ú–æ–∂–Ω–æ
- –ß–∏—Ç–∞—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü–æ–ª—É—á–∞—Ç—å –æ–ø—Ü–∏–æ–Ω–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—á—ë—Ç—ã Greeks
- –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### ‚ùå –ù–µ–ª—å–∑—è
- **–†–∞–∑–º–µ—â–∞—Ç—å –æ—Ä–¥–µ—Ä–∞** (–Ω–∏–∫–∞–∫–∏—Ö `placeOrder`, `cancelOrder`)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å clientId=101 (—ç—Ç–æ –õ–µ–≤–æ–Ω)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å clientId=100 (—ç—Ç–æ Backend)
- –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç—è–∂—ë–ª—ã–µ —Ç–µ—Å—Ç—ã –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

---

## Troubleshooting

### –û—à–∏–±–∫–∞: "Connection refused"
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç—É–Ω–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç
lsof -i :4002

# –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –æ—Ç–∫—Ä—ã—Ç—å –∑–∞–Ω–æ–≤–æ
./connect_to_prod_tws_andrey.sh
```

### –û—à–∏–±–∫–∞: "TimeoutError"
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ TWS –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø—Ä–æ–¥–µ (—Å–ø—Ä–æ—Å–∏ –≤ —á–∞—Ç–µ)
- –ü—Ä–æ–≤–µ—Ä—å SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: `ssh -i ~/.ssh/id_optioner root@89.117.52.143`

### –û—à–∏–±–∫–∞: "Client ID already in use"
- –ö—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–≤–æ–π clientId (102)
- –ò–ª–∏ —Ç—ã –ø–æ–¥–∫–ª—é—á—ë–Ω –¥–≤–∞–∂–¥—ã ‚Äî –∑–∞–∫—Ä–æ–π –≤—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### –ó–∞–∫—Ä—ã—Ç—å —Ç—É–Ω–Ω–µ–ª—å
```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å
lsof -i :4002

# –£–±–∏—Ç—å –≤—Å–µ SSH —Ç—É–Ω–Ω–µ–ª–∏ –Ω–∞ 4002
pkill -f 'ssh.*4002'
```

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –ø–∏—à–∏ –≤ —á–∞—Ç!
