# ü™ü –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Windows

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

1. **Python 3.8+** ‚Äî —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
2. **SSH –∫–ª—é—á** ‚Äî `id_optioner` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å)
3. **PuTTY** ‚Äî –¥–ª—è SSH —Ç—É–Ω–Ω–µ–ª–µ–π
4. **VNC Viewer** ‚Äî –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ü–û

### 1. PuTTY (–¥–ª—è SSH —Ç—É–Ω–Ω–µ–ª–µ–π)

**–°–∫–∞—á–∞—Ç—å:**
- https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html

**–ù—É–∂–Ω—ã —Ñ–∞–π–ª—ã:**
- `putty.exe` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç
- `pageant.exe` ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –∫–ª—é—á–µ–π
- `puttygen.exe` ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∫–ª—é—á–µ–π

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
1. –°–∫–∞—á–∞—Ç—å `putty-64bit-0.79-installer.msi`
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ `C:\Program Files\PuTTY`

### 2. VNC Viewer (–¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ GUI)

**–°–∫–∞—á–∞—Ç—å:**
- https://www.realvnc.com/download/viewer/

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
1. –°–∫–∞—á–∞—Ç—å `VNC-Viewer-7.x.x-Windows.exe`
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

### 3. ib_insync (Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)

```bash
pip install ib_insync
```

---

## –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SSH –∫–ª—é—á–∞

–ï—Å–ª–∏ —É —Ç–µ–±—è –∫–ª—é—á –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.pem` (OpenSSH), –Ω—É–∂–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ `.ppk` (PuTTY):

1. –û—Ç–∫—Ä—ã—Ç—å `puttygen.exe`
2. –ù–∞–∂–∞—Ç—å "Load"
3. –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª `id_optioner`
4. –ù–∞–∂–∞—Ç—å "Save private key"
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ `id_optioner.ppk`

---

## –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –¢–µ—Ä–º–∏–Ω–∞–ª 1: SSH —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è TWS API (–ø–æ—Ä—Ç 4002)

1. –û—Ç–∫—Ä—ã—Ç—å `pageant.exe`
2. –ù–∞–∂–∞—Ç—å "Add Key"
3. –í—ã–±—Ä–∞—Ç—å `id_optioner.ppk`
4. –û—Ç–∫—Ä—ã—Ç—å `putty.exe`
5. Host: `89.117.52.143`
6. Connection ‚Üí SSH ‚Üí Auth ‚Üí Private key file: –≤—ã–±—Ä–∞—Ç—å `id_optioner.ppk`
7. Connection ‚Üí SSH ‚Üí Tunnels:
   - Source port: `4002`
   - Destination: `127.0.0.1:4002`
   - –ù–∞–∂–∞—Ç—å "Add"
8. –ù–∞–∂–∞—Ç—å "Open"
9. –û—Å—Ç–∞–≤–∏—Ç—å –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã–º

### –¢–µ—Ä–º–∏–Ω–∞–ª 2: SSH —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è VNC (–ø–æ—Ä—Ç 5900)

1. –û—Ç–∫—Ä—ã—Ç—å –µ—â—ë –æ–¥–∏–Ω `putty.exe`
2. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —à–∞–≥–∏ 5-8, –Ω–æ —Å:
   - Source port: `5900`
   - Destination: `127.0.0.1:5900`

### –¢–µ—Ä–º–∏–Ω–∞–ª 3: VNC –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

1. –û—Ç–∫—Ä—ã—Ç—å VNC Viewer
2. –ê–¥—Ä–µ—Å: `127.0.0.1:5900`
3. –ü–∞—Ä–æ–ª—å: `9556017`
4. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ TWS:
   - Username: `bogda6172`
   - Password: `19642014angel`

### –¢–µ—Ä–º–∏–Ω–∞–ª 4: PowerShell/CMD –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤

```bash
cd path\to\ANDREY_SETUP
python query_es_contracts_simple.py
```

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: WSL2 (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

–ï—Å–ª–∏ —É —Ç–µ–±—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω WSL2 (Windows Subsystem for Linux), –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Linux –∫–æ–º–∞–Ω–¥—ã:

```bash
# –í WSL2 —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
wsl

# –í–Ω—É—Ç—Ä–∏ WSL2
ssh -i ~/.ssh/id_optioner -L 4002:127.0.0.1:4002 -N root@89.117.52.143

# –í –¥—Ä—É–≥–æ–º WSL2 —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
ssh -i ~/.ssh/id_optioner -L 5900:127.0.0.1:5900 -N root@89.117.52.143

# –í PowerShell
python query_es_contracts_simple.py
```

---

## Troubleshooting –¥–ª—è Windows

### –û—à–∏–±–∫–∞: "PuTTY: command not found"

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å PuTTY –≤ PATH
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å: `C:\Program Files\PuTTY\putty.exe`

### –û—à–∏–±–∫–∞: "Connection refused"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–±–∞ PuTTY –æ–∫–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—ã
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç—É–Ω–Ω–µ–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å PuTTY

### –û—à–∏–±–∫–∞: "VNC authentication failed"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å: `9556017`
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç—É–Ω–Ω–µ–ª—å –Ω–∞ 5900 –æ—Ç–∫—Ä—ã—Ç
3. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

### Python —Å–∫—Ä–∏–ø—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Python —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `python --version`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ ib_insync —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `pip list | grep ib_insync`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç—É–Ω–Ω–µ–ª—å –Ω–∞ 4002 –æ—Ç–∫—Ä—ã—Ç: `netstat -an | findstr 4002`

---

## üìå –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| SSH Host | 89.117.52.143 |
| SSH Port | 22 |
| SSH Key | id_optioner.ppk |
| TWS Port | 4002 |
| VNC Port | 5900 |
| VNC Password | 9556017 |
| IB Username | bogda6172 |
| IB Password | 19642014angel |
| ClientId | 102 |

---

## üéØ –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞

```
1. –û—Ç–∫—Ä—ã—Ç—å pageant.exe + –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–ª—é—á
2. –û—Ç–∫—Ä—ã—Ç—å putty.exe (—Ç—É–Ω–Ω–µ–ª—å 4002)
3. –û—Ç–∫—Ä—ã—Ç—å putty.exe (—Ç—É–Ω–Ω–µ–ª—å 5900)
4. –û—Ç–∫—Ä—ã—Ç—å VNC Viewer ‚Üí 127.0.0.1:5900
5. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ VNC (–ø–∞—Ä–æ–ª—å: 9556017)
6. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ TWS (bogda6172 / 19642014angel)
7. –í PowerShell: python query_es_contracts_simple.py
```

---

**–î–∞—Ç–∞:** 18 –Ω–æ—è–±—Ä—è 2025  
**–î–ª—è:** Windows –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
