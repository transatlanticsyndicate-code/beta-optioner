# –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞—Å—á—ë—Ç–∞ P/L –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–æ–¥–±–æ—Ä–æ–º –æ–ø—Ü–∏–æ–Ω–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü–µ–π

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏ –ø–æ–¥–±–æ—Ä–µ –æ–ø—Ü–∏–æ–Ω–æ–≤ (AI Option Selector) –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –æ–ø—Ü–∏–æ–Ω–æ–≤ (Options Table) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å **—Ä–∞–∑–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (IV)**, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—é –≤ —Ä–∞—Å—á—ë—Ç–∞—Ö P/L –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –æ–ø—Ü–∏–æ–Ω–∞.

### –°–∏–º–ø—Ç–æ–º—ã –ø—Ä–æ–±–ª–µ–º—ã:
- P/L –≤ –æ–∫–Ω–µ –ø–æ–¥–±–æ—Ä–∞ –æ–ø—Ü–∏–æ–Ω–æ–≤ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç P/L –≤ —Ç–∞–±–ª–∏—Ü–µ –æ–ø—Ü–∏–æ–Ω–æ–≤
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–¥–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–ø—Ü–∏–æ–Ω–∞ –≤ —Ç–∞–±–ª–∏—Ü—É, –∑–Ω–∞—á–µ–Ω–∏—è P/L –º–µ–Ω—è—é—Ç—Å—è
- –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –≤ –ª–æ–≥–∞—Ö –ø–æ–¥–±–æ—Ä–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é –≤ —Ç–∞–±–ª–∏—Ü–µ

### –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:
1. **–ü–æ–¥–±–æ—Ä –æ–ø—Ü–∏–æ–Ω–æ–≤** –ø–æ–ª—É—á–∞–µ—Ç IV –∏–∑ API —Ü–µ–ø–æ—á–∫–∏ –æ–ø—Ü–∏–æ–Ω–æ–≤ (`getOptionsChain`)
2. **–¢–∞–±–ª–∏—Ü–∞ –æ–ø—Ü–∏–æ–Ω–æ–≤** –ø–æ–ª—É—á–∞–µ—Ç IV –∏–∑ API –¥–µ—Ç–∞–ª–µ–π –æ–ø—Ü–∏–æ–Ω–∞ (`getOptionDetails`)
3. –≠—Ç–∏ –¥–≤–∞ API –º–æ–≥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å **—Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è IV** –¥–ª—è –æ–¥–Ω–æ–≥–æ –æ–ø—Ü–∏–æ–Ω–∞
4. –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ–ø—Ü–∏–æ–Ω–∞ –∏–∑ –ø–æ–¥–±–æ—Ä–∞, IV **–Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∞—Å—å** –≤ –æ–±—ä–µ–∫—Ç –æ–ø—Ü–∏–æ–Ω–∞
5. –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–µ—Ç–∞–ª–µ–π –æ–ø—Ü–∏–æ–Ω–∞, IV –∏–∑ API **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–ª–∞** –ª—é–±–æ–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

---

## –†–µ—à–µ–Ω–∏–µ

### –ü—Ä–∏–Ω—Ü–∏–ø: "–ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è IV"

IV, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏ –ø–æ–¥–±–æ—Ä–µ –æ–ø—Ü–∏–æ–Ω–∞, –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ –æ–ø—Ü–∏–æ–Ω–æ–≤ –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ P/L.

---

## –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ü–µ—Ä–µ–¥–∞—á–∞ IV –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ–ø—Ü–∏–æ–Ω–∞ –∏–∑ –ø–æ–¥–±–æ—Ä–∞

**–§–∞–π–ª:** `pages/OptionsCalculatorBasic.jsx` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞)

**–ú–µ—Å—Ç–æ:** –§—É–Ω–∫—Ü–∏—è `onAddOption` –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ AI –ø–æ–¥–±–æ—Ä–∞ –æ–ø—Ü–∏–æ–Ω–æ–≤

**–ë—ã–ª–æ:**
```javascript
const newOption = {
  id: newOptionId,
  action: option.action || 'Buy',
  type: option.type || 'PUT',
  strike: option.strike,
  date: option.expirationDate,
  quantity: 1,
  premium: option.premium || 0,
  bid: option.bid || 0,
  ask: option.ask || 0,
  volume: option.volume || 0,
  oi: option.openInterest || 0,
  delta: option.delta || 0,
  visible: true,
  isLoadingDetails: true,
  bestExitDay: bestExitDay,
};
```

**–°—Ç–∞–ª–æ:**
```javascript
const newOption = {
  id: newOptionId,
  action: option.action || 'Buy',
  type: option.type || 'PUT',
  strike: option.strike,
  date: option.expirationDate,
  quantity: 1,
  premium: option.premium || 0,
  bid: option.bid || 0,
  ask: option.ask || 0,
  volume: option.volume || 0,
  oi: option.openInterest || 0,
  delta: option.delta || 0,
  // –í–ê–ñ–ù–û: –ü–µ—Ä–µ–¥–∞—ë–º IV –∏–∑ –ø–æ–¥–±–æ—Ä–∞ –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ P/L
  // –ó–ê–ß–ï–ú: IV –∏–∑ –ø–æ–¥–±–æ—Ä–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å IV –≤ —Ç–∞–±–ª–∏—Ü–µ
  impliedVolatility: option.iv || option.impliedVolatility || 0,
  visible: true,
  isLoadingDetails: true,
  bestExitDay: bestExitDay,
};
```

---

### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ IV –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–µ—Ç–∞–ª–µ–π –æ–ø—Ü–∏–æ–Ω–∞

**–§–∞–π–ª:** `pages/OptionsCalculatorBasic.jsx` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π)

**–ú–µ—Å—Ç–æ:** –§—É–Ω–∫—Ü–∏—è `loadOptionDetails` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–ø—Ü–∏–æ–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–µ–π

**–ë—ã–ª–æ:**
```javascript
setOptions(prevOptions => 
  prevOptions.map(opt => 
    opt.id === optionId ? {
      ...opt,
      premium: details.premium || 0,
      bid: details.bid || 0,
      ask: details.ask || 0,
      // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
      impliedVolatility: details.implied_volatility || 0,  // ‚ùå –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç IV
      isLoadingDetails: false,
    } : opt
  )
);
```

**–°—Ç–∞–ª–æ:**
```javascript
setOptions(prevOptions => 
  prevOptions.map(opt => 
    opt.id === optionId ? {
      ...opt,
      premium: details.premium || 0,
      bid: details.bid || 0,
      ask: details.ask || 0,
      // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
      // –í–ê–ñ–ù–û: –°–æ—Ö—Ä–∞–Ω—è–µ–º IV –∏–∑ –ø–æ–¥–±–æ—Ä–∞ –µ—Å–ª–∏ –æ–Ω–∞ —É–∂–µ –µ—Å—Ç—å
      // –ó–ê–ß–ï–ú: –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å P/L –º–µ–∂–¥—É –ø–æ–¥–±–æ—Ä–æ–º –∏ —Ç–∞–±–ª–∏—Ü–µ–π
      impliedVolatility: opt.impliedVolatility || details.implied_volatility || 0,  // ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π IV
      isLoadingDetails: false,
    } : opt
  )
);
```

---

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á—ë—Ç–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

**–§–∞–π–ª:** `utils/volatilitySurface/projection.js`

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `getOptionVolatility` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö —Ä–∞—Å—á—ë—Ç–∞ P/L:

```javascript
/**
 * –í—ã—á–∏—Å–ª—è–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—É—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –æ–ø—Ü–∏–æ–Ω–∞
 * –ó–ê–ß–ï–ú: –ï–¥–∏–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ IV –≤–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö
 * @returns {number} –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, 25 –¥–ª—è 25%)
 */
export const getOptionVolatility = (
  option, 
  currentDaysToExpiration = null, 
  simulatedDaysToExpiration = null, 
  ivSurface = null
) => {
  const optIV = option.impliedVolatility || option.implied_volatility;
  if (!optIV || optIV <= 0) {
    return DEFAULT_IV_PERCENT; // Fallback (–æ–±—ã—á–Ω–æ 25%)
  }
  
  // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –µ—Å–ª–∏ –≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
  const currentIVPercent = optIV < 1 ? optIV * 100 : optIV;
  
  // –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –≤—Ä–µ–º–µ–Ω–∏ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—É—é IV
  if (currentDaysToExpiration !== null && simulatedDaysToExpiration !== null && 
      simulatedDaysToExpiration < currentDaysToExpiration && simulatedDaysToExpiration > 0) {
    const projectedIV = getProjectedIV(option, currentDaysToExpiration, simulatedDaysToExpiration, ivSurface);
    return projectedIV;
  }
  
  return currentIVPercent;
};
```

---

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞—Å—á—ë—Ç–∞ P/L –≤ –ø–æ–¥–±–æ—Ä–µ –æ–ø—Ü–∏–æ–Ω–æ–≤

**–§–∞–π–ª:** `components/CalculatorV2/AIOptionSelector/aiOptionSelectorUtils.js`

**–§—É–Ω–∫—Ü–∏–∏:** `calculatePutPLBlackScholes`, `calculateCallPLBlackScholes`

```javascript
import { getOptionVolatility } from '../../../utils/volatilitySurface';
import { calculateOptionPLValue } from '../../../utils/optionPricing';

export function calculatePutPLBlackScholes(putOption, targetPrice, daysRemaining, currentDaysToExpiration = null) {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º getOptionVolatility –∫–∞–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ –æ–ø—Ü–∏–æ–Ω–æ–≤
  // –ó–ê–ß–ï–ú: –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ P/L
  const currentDays = currentDaysToExpiration !== null ? currentDaysToExpiration : daysRemaining;
  const optionVolatility = getOptionVolatility(putOption, currentDays, daysRemaining);
  
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç—É –∂–µ —Ñ—É–Ω–∫—Ü–∏—é —á—Ç–æ –∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä, –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —è–≤–Ω–æ
  const pl = calculateOptionPLValue(putOption, targetPrice, targetPrice, daysRemaining, optionVolatility);
  return pl;
}
```

---

### 5. –ü–µ—Ä–µ–¥–∞—á–∞ IV –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø–æ–¥–±–æ—Ä–∞

**–§–∞–π–ª:** `components/CalculatorV2/AIOptionSelector/aiOptionSelectorUtils.js`

**–§—É–Ω–∫—Ü–∏—è:** `filterAndRankPutOptions` (–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –¥–ª—è CALL)

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ IV –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```javascript
results.push({
  expirationDate: expData.date,
  daysUntil: expData.daysUntil,
  strike: put.strike,
  premium: put.premium,
  bid: put.bid,
  ask: put.ask,
  volume: put.volume,
  openInterest: put.openInterest,
  delta: put.delta,
  iv: put.iv,  // ‚úÖ –í–ê–ñ–ù–û: –ü–µ—Ä–µ–¥–∞—ë–º IV
  ...riskCheck
});
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω BID –∏ ASK –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ P/L

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ!

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ P/L **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã —Ü–µ–Ω—ã BID –∏ ASK –≤ –ø–æ–¥–±–æ—Ä–µ –æ–ø—Ü–∏–æ–Ω–æ–≤.

### –ü—Ä–∞–≤–∏–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ü–µ–Ω:

| –î–µ–π—Å—Ç–≤–∏–µ | –¶–µ–Ω–∞ –≤—Ö–æ–¥–∞ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|----------|------------|-------------|
| **Buy** (–ø–æ–∫—É–ø–∫–∞) | **ASK** | –ü–æ–∫—É–ø–∞–µ–º –ø–æ —Ü–µ–Ω–µ –ø—Ä–æ–¥–∞–≤—Ü–∞ (ask) |
| **Sell** (–ø—Ä–æ–¥–∞–∂–∞) | **BID** | –ü—Ä–æ–¥–∞—ë–º –ø–æ —Ü–µ–Ω–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (bid) |

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∫–æ–¥–µ:

**–§–∞–π–ª:** `utils/optionPricing.js`

```javascript
const getEntryPrice = (option = {}) => {
  const isBuy = isBuyAction(option);
  
  if (isBuy) {
    // –ü–æ–∫—É–ø–∫–∞: –≤—Ö–æ–¥–∏–º –ø–æ ASK (—Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞)
    const ask = toNumber(option.ask);
    if (ask > 0) return ask;
  } else {
    // –ü—Ä–æ–¥–∞–∂–∞: –≤—Ö–æ–¥–∏–º –ø–æ BID (—Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è)
    const bid = toNumber(option.bid);
    if (bid > 0) return bid;
  }
  
  // Fallback –Ω–∞ premium –µ—Å–ª–∏ bid/ask –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
  return Math.max(0, toNumber(option.premium));
};
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è BID/ASK –≤ –ø–æ–¥–±–æ—Ä–µ:

**–§–∞–π–ª:** `components/CalculatorV2/AIOptionSelector/aiOptionSelectorUtils.js`

```javascript
// –ü—Ä–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ API
const normalizedPuts = filteredPuts.map(opt => {
  const bid = opt.bid || 0;
  const ask = opt.ask || 0;
  // ...
  return {
    strike,
    premium,
    bid,  // ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–¥–∞—ë–º BID
    ask,  // ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–¥–∞—ë–º ASK
    // ...
  };
});

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
const withBidAsk = normalizedPuts.filter(p => p.bid > 0 && p.ask > 0).length;
if (withBidAsk < normalizedPuts.length) {
  console.warn(`‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ü–∏–æ–Ω—ã –ë–ï–ó bid/ask –¥–∞–Ω–Ω—ã—Ö!`);
}
```

### –ü–µ—Ä–µ–¥–∞—á–∞ BID/ASK –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ–ø—Ü–∏–æ–Ω–∞:

```javascript
const newOption = {
  // ...
  bid: option.bid || 0,  // ‚úÖ –ü–µ—Ä–µ–¥–∞—ë–º BID
  ask: option.ask || 0,  // ‚úÖ –ü–µ—Ä–µ–¥–∞—ë–º ASK
  premium: option.premium || 0,  // Fallback
  // ...
};
```

---

## –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö IV

### API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç IV –≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:
- `0.25` = 25%
- `0.50` = 50%

### –§—É–Ω–∫—Ü–∏—è `getOptionVolatility` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç IV –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö:
- `25` = 25%
- `50` = 50%

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:
```javascript
// –î–µ—Å—è—Ç–∏—á–Ω—ã–π ‚Üí –ü—Ä–æ—Ü–µ–Ω—Ç—ã
const ivPercent = ivDecimal < 1 ? ivDecimal * 100 : ivDecimal;

// –ü—Ä–æ—Ü–µ–Ω—Ç—ã ‚Üí –î–µ—Å—è—Ç–∏—á–Ω—ã–π
const ivDecimal = ivPercent > 1 ? ivPercent / 100 : ivPercent;
```

---

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π –¥–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

### –í –ø–æ–¥–±–æ—Ä–µ –æ–ø—Ü–∏–æ–Ω–æ–≤:
```javascript
console.log(`[AISelector] üìà Strike $${option.strike}: rawIV=${option.iv}, IV=${optionVolatility.toFixed(1)}%`);
```

### –í —Ç–∞–±–ª–∏—Ü–µ –æ–ø—Ü–∏–æ–Ω–æ–≤:
```javascript
const rawIV = option.impliedVolatility || option.implied_volatility;
console.log(`[–¢–∞–±–ª–∏—Ü–∞] üìà Strike $${option.strike}: rawIV=${rawIV}, IV=${(optionVolatility * 100).toFixed(1)}%`);
```

---

## –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] **BID –∏ ASK** –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∏–∑ –ø–æ–¥–±–æ—Ä–∞ –≤ `newOption`
- [ ] –§—É–Ω–∫—Ü–∏—è `getEntryPrice` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ASK –¥–ª—è Buy –∏ BID –¥–ª—è Sell
- [ ] IV –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∏–∑ –ø–æ–¥–±–æ—Ä–∞ –≤ `newOption.impliedVolatility`
- [ ] `loadOptionDetails` –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é IV
- [ ] –§—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á—ë—Ç–∞ P/L –∏—Å–ø–æ–ª—å–∑—É—é—Ç `getOptionVolatility`
- [ ] IV –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö `filterAndRankPutOptions`
- [ ] **ivSurface** –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ `OptionSelectionResult` –∏ –¥–∞–ª–µ–µ –≤ `usePositionExitCalculator`
- [ ] **dividendYield** –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ `OptionSelectionResult` –∏ –¥–∞–ª–µ–µ –≤ `usePositionExitCalculator`
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è BID/ASK/IV –≤ –ø–æ–¥–±–æ—Ä–µ –∏ —Ç–∞–±–ª–∏—Ü–µ
- [ ] –¶–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è –æ–ø—Ü–∏–æ–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç –≤ –±–ª–æ–∫–∞—Ö "–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥–±–æ—Ä–∞" –∏ "–†–∞—Å—á—ë—Ç –≤—ã—Ö–æ–¥–∞"
- [ ] P/L –≤ –ø–æ–¥–±–æ—Ä–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å P/L –≤ —Ç–∞–±–ª–∏—Ü–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–ø—Ü–∏–æ–Ω–∞

---

## 6. –ü–µ—Ä–µ–¥–∞—á–∞ ivSurface –∏ dividendYield –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–¥–±–æ—Ä–∞

**–§–∞–π–ª:** `components/CalculatorV2/OptionSelectionResult/index.jsx`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `OptionSelectionResult` –Ω–µ –ø–æ–ª—É—á–∞–ª –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `ivSurface` –∏ `dividendYield`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—é –≤ —Ä–∞—Å—á—ë—Ç–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π —Ü–µ–Ω—ã –æ–ø—Ü–∏–æ–Ω–∞ –º–µ–∂–¥—É –±–ª–æ–∫–æ–º "–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥–±–æ—Ä–∞" –∏ –±–ª–æ–∫–æ–º "–†–∞—Å—á—ë—Ç –≤—ã—Ö–æ–¥–∞".

**–°–∏–º–ø—Ç–æ–º:** –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–ø—Ü–∏–æ–Ω–∞ –≤ –±–ª–æ–∫–µ "–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥–±–æ—Ä–∞ BuyPUT" –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ü–µ–Ω—ã –≤ –±–ª–æ–∫–µ "–†–∞—Å—á—ë—Ç –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–∑–∏—Ü–∏–∏" –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö (IV, –¥–Ω–∏ –¥–æ —ç–∫—Å–ø–∏—Ä–∞—Ü–∏–∏, —Ü–µ–Ω–∞ –∞–∫—Ç–∏–≤–∞).

**–ë—ã–ª–æ:**
```javascript
export function OptionSelectionResult({
  selectionParams = null,
  options = [],
  positions = [],
  currentPrice = 0
}) {
  // ...
  const plDown = usePositionExitCalculator({
    underlyingPrice: targetDownPrice,
    daysPassed: daysAfterEntry,
    options,
    positions,
    currentPrice
    // ‚ùå ivSurface –∏ dividendYield –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è
  });
}
```

**–°—Ç–∞–ª–æ:**
```javascript
export function OptionSelectionResult({
  selectionParams = null,
  options = [],
  positions = [],
  currentPrice = 0,
  ivSurface = null,        // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä
  dividendYield = 0        // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä
}) {
  // ...
  const plDown = usePositionExitCalculator({
    underlyingPrice: targetDownPrice,
    daysPassed: daysAfterEntry,
    options,
    positions,
    currentPrice,
    ivSurface,              // ‚úÖ –ü–µ—Ä–µ–¥–∞—ë–º ivSurface
    dividendYield           // ‚úÖ –ü–µ—Ä–µ–¥–∞—ë–º dividendYield
  });
}
```

**–ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:**

**–§–∞–π–ª:** `pages/OptionsCalculatorBasic.jsx`

```javascript
<OptionSelectionResult
  selectionParams={optionSelectionParams}
  options={displayOptions}
  positions={positions}
  currentPrice={currentPrice}
  ivSurface={ivSurface}                              // ‚úÖ –ü–µ—Ä–µ–¥–∞—ë–º IV Surface
  dividendYield={useDividends ? dividendYield : 0}   // ‚úÖ –ü–µ—Ä–µ–¥–∞—ë–º dividend yield
/>
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:**

1. **ivSurface** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `getOptionVolatility` –¥–ª—è —Ç–æ—á–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –¥–∞—Ç–∞–º–∏ —ç–∫—Å–ø–∏—Ä–∞—Ü–∏–∏
2. –ë–µ–∑ `ivSurface` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Ä–æ—Å—Ç–∞ IV, –∫–æ—Ç–æ—Ä–∞—è –¥–∞—ë—Ç –¥—Ä—É–≥–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
3. **dividendYield** –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å—á—ë—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π —Ü–µ–Ω—ã –æ–ø—Ü–∏–æ–Ω–∞ –ø–æ –º–æ–¥–µ–ª–∏ Black-Scholes-Merton
4. –†–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—é –≤ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π —Ü–µ–Ω–µ –æ–ø—Ü–∏–æ–Ω–∞ –∏ P/L

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `pages/OptionsCalculatorBasic.jsx` | –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞, `onAddOption`, `loadOptionDetails` |
| `components/CalculatorV2/AIOptionSelector/aiOptionSelectorUtils.js` | –õ–æ–≥–∏–∫–∞ –ø–æ–¥–±–æ—Ä–∞ –æ–ø—Ü–∏–æ–Ω–æ–≤, —Ä–∞—Å—á—ë—Ç P/L |
| `components/CalculatorV2/AIOptionSelector/AIOptionSelectorDialog.jsx` | UI –ø–æ–¥–±–æ—Ä–∞, –ø–µ—Ä–µ–¥–∞—á–∞ –æ–ø—Ü–∏–æ–Ω–∞ –≤ `onAddOption` |
| `components/CalculatorV2/OptionsTable.jsx` | –¢–∞–±–ª–∏—Ü–∞ –æ–ø—Ü–∏–æ–Ω–æ–≤, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ P/L |
| `components/CalculatorV2/OptionSelectionResult/index.jsx` | –ë–ª–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–¥–±–æ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `usePositionExitCalculator` |
| `hooks/usePositionExitCalculator.js` | –•—É–∫ —Ä–∞—Å—á—ë—Ç–∞ P/L –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ivSurface` –∏ `dividendYield` |
| `utils/volatilitySurface/projection.js` | –§—É–Ω–∫—Ü–∏—è `getOptionVolatility`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ivSurface` –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ |
| `utils/optionPricing.js` | –§—É–Ω–∫—Ü–∏—è `calculateOptionPLValue`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `dividendYield` |

---

## –ê–≤—Ç–æ—Ä –∏ –¥–∞—Ç–∞

- **–î–∞—Ç–∞:** 2024-12-23
- **–ü—Ä–æ–µ–∫—Ç:** Optioner v21
- **–ó–∞–¥–∞—á–∞:** –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞—Å—á—ë—Ç–∞ P/L –º–µ–∂–¥—É –ø–æ–¥–±–æ—Ä–æ–º –∏ —Ç–∞–±–ª–∏—Ü–µ–π –æ–ø—Ü–∏–æ–Ω–æ–≤
