# üìö IB API Migration - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–î–∞—Ç–∞:** 23 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π IBEAM —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üöÄ –ù–∞—á–Ω–∏ –æ—Ç—Å—é–¥–∞

1. **[QUICK_REFERENCE.md](QUICK_REFERENCE.md)** - ‚ö° –ó–∞ 30 —Å–µ–∫—É–Ω–¥
   - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
   - –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
   - –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

2. **[LOCAL_IBEAM_SETUP.md](LOCAL_IBEAM_SETUP.md)** - üìö –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
   - –í—Å–µ API endpoints
   - Troubleshooting
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

### üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–µ—à–µ–Ω–∏—è

3. **[../architecture/IBEAM_PROXY_SOLUTION.md](../architecture/IBEAM_PROXY_SOLUTION.md)** - üîê –ü—Ä–æ–∫—Å–∏ —á–µ—Ä–µ–∑ docker exec
   - –ü—Ä–æ–±–ª–µ–º–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ
   - –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ–∫—Å–∏
   - –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

---

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ

| –°–∫—Ä–∏–ø—Ç | –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –í—Ä–µ–º—è |
|--------|------|-----------|-------|
| **–ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç AAPL** | `backend/tests/test_aapl_final.py` | –í—Å–µ –¥–∞–Ω–Ω—ã–µ AAPL | ~2 —Å–µ–∫ |
| **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏** | `backend/tests/test_speed_comparison.py` | –õ–æ–∫–∞–ª—å–Ω—ã–π vs –ü—Ä–æ–∫—Å–∏ | ~5 —Å–µ–∫ |
| **IBClient —Ç–µ—Å—Ç** | `backend/tests/test_local_ibeam.py` | –¢–µ—Å—Ç –∫–ª–∞—Å—Å–∞ IBClient | ~30 —Å–µ–∫ |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ

| –°–∫—Ä–∏–ø—Ç | –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------|-----------|
| SSH —Ç—É–Ω–Ω–µ–ª—å | `backend/tests/test_tunnel.py` | –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è |
| –ü—Ä–æ–∫—Å–∏ –ø–æ–ª–Ω—ã–π | `backend/tests/test_proxy_full.py` | –ú–µ–¥–ª–µ–Ω–Ω–æ |

### –ó–∞–ø—É—Å–∫

```bash
cd backend

# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
python tests/test_aapl_final.py

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
python tests/test_speed_comparison.py

# –¢–µ—Å—Ç IBClient
python tests/test_local_ibeam.py
```

---

## üîå API Endpoints

### –ë–∞–∑–æ–≤—ã–π URL
```
https://localhost:5001/v1
```

### –û—Å–Ω–æ–≤–Ω—ã–µ

```bash
# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
GET /portal/iserver/auth/status

# –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
GET /api/iserver/secdef/search?symbol=AAPL

# –¶–µ–Ω–∞
GET /api/iserver/marketdata/snapshot?conids=265598&fields=31,84,86

# –°—Ç—Ä–∞–π–∫–∏
GET /api/iserver/secdef/strikes?conid=265598&sectype=OPT&month=NOV25
```

**–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫:** —Å–º. [LOCAL_IBEAM_SETUP.md](LOCAL_IBEAM_SETUP.md#-api-endpoints)

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ò–∑–º–µ—Ä–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (23 –æ–∫—Ç—è–±—Ä—è 2025)

```
–õ–æ–∫–∞–ª—å–Ω—ã–π IBEAM:  112ms (—Å—Ä–µ–¥–Ω–µ–µ)
–ü—Ä–æ–∫—Å–∏ (docker):  475ms (—Å—Ä–µ–¥–Ω–µ–µ)
–£—Å–∫–æ—Ä–µ–Ω–∏–µ:        –≤ 4.2 —Ä–∞–∑–∞! üöÄ
```

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è |
|----------|-------|
| Auth check | 98ms |
| –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ | 796ms |
| –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω—ã | 139ms |
| –î–∞—Ç—ã —ç–∫—Å–ø–∏—Ä–∞—Ü–∏–∏ | 183ms |
| –°—Ç—Ä–∞–π–∫–∏ | 495ms |
| **–ò—Ç–æ–≥–æ** | **~1.7 —Å–µ–∫** |

---

## üê≥ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞ 3 –º–∏–Ω—É—Ç—ã

```bash
# 1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd ~/ibeam-local

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose up -d

# 3. –î–æ–∂–¥–∞—Ç—å—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (30-60 —Å–µ–∫)
docker compose logs -f

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl -k https://localhost:5001/v1/portal/iserver/auth/status

# 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
python /path/to/backend/tests/test_aapl_final.py
```

---

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### IBClient

```python
import os
from app.services.ib_client import IBClient

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π IBEAM
os.environ["IB_API_URL"] = "https://localhost:5001"
os.environ.pop("IBEAM_PROXY_API_KEY", None)

# –°–±—Ä–æ—Å–∏—Ç—å Singleton
IBClient._instance = None

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
client = IBClient()
price = client.get_stock_price("AAPL")
dates = client.get_expiration_dates("AAPL")
chain = client.get_options_chain("AAPL", "NOV25")
```

### –ü—Ä—è–º—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã

```python
import requests
import urllib3

urllib3.disable_warnings()
session = requests.Session()
session.verify = False

# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
resp = session.get("https://localhost:5001/v1/portal/iserver/auth/status")
print(resp.json())

# –¶–µ–Ω–∞ AAPL
resp = session.get(
    "https://localhost:5001/v1/api/iserver/marketdata/snapshot",
    params={"conids": 265598, "fields": "31,84,86"}
)
print(resp.json())
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚úÖ
- –ò—Å–ø–æ–ª—å–∑—É–π **–ª–æ–∫–∞–ª—å–Ω—ã–π IBEAM** (–ø–æ—Ä—Ç 5001)
- –ó–∞–ø—É—Å–∫–∞–π —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º
- –ü—Ä–æ–≤–µ—Ä—è–π —Å–∫–æ—Ä–æ—Å—Ç—å —á–µ—Ä–µ–∑ `test_speed_comparison.py`

### –î–ª—è production ‚úÖ
- –ò—Å–ø–æ–ª—å–∑—É–π **–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø** –∫ IBEAM –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ò–ª–∏ **–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–∫—Å–∏**
- –î–æ–±–∞–≤—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –î–ª—è CI/CD ‚úÖ
- –ò—Å–ø–æ–ª—å–∑—É–π **–ø—Ä–æ–∫—Å–∏** –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- –ò–ª–∏ –∑–∞–ø—É—Å–∫–∞–π **–ª–æ–∫–∞–ª—å–Ω—ã–π IBEAM** –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- –ü—Ä–æ–≤–µ—Ä—è–π —á—Ç–æ –≤—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üìä –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

### IBEAM Account
```
Account: bogda6172
Password: 19642014angel
Mode: Paper Trading
```

### IB Account
```
Account ID: DU4883788
Name: BOHDAN KOPYTKO
Type: DEMO (Paper Trading)
Currency: USD
```

### –¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
```
AAPL (Apple Inc)
- ConID: 265598
- –î–∞—Ç—ã: OCT25, NOV25, DEC25, JAN26, FEB26, ...
- –°—Ç—Ä–∞–π–∫–∏: 100-350 (63 —Å—Ç—Ä–∞–π–∫–∞ –¥–ª—è NOV25)

SPY (S&P 500 ETF)
- ConID: 756733
- –î–∞—Ç—ã: OCT25, NOV25, DEC25, JAN26, ...
- –°—Ç—Ä–∞–π–∫–∏: 400-700 (–º–Ω–æ–≥–æ —Å—Ç—Ä–∞–π–∫–æ–≤)
```

---

## üîó –°—Å—ã–ª–∫–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [IBEAM GitHub](https://github.com/Voyz/ibeam)
- [IB Client Portal API](https://www.interactivebrokers.com/campus/ibkr-api-page/cpapi-v1/)
- [IB API Forum](https://groups.io/g/twsapi)

### –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
- **IBClient:** `backend/app/services/ib_client.py`
- **–ü—Ä–æ–∫—Å–∏:** `backend/app/api/ibeam_secure_proxy.py`
- **–ö–æ–Ω—Ñ–∏–≥:** `~/ibeam-local/docker-compose.yml`
- **–¢–µ—Å—Ç—ã:** `backend/tests/test_*.py`

---

## üìù –ò—Å—Ç–æ—Ä–∏—è

### 23 –æ–∫—Ç—è–±—Ä—è 2025 - v1.0
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π IBEAM —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –í—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑–º–µ—Ä–µ–Ω–∞ (4.2x –±—ã—Å—Ç—Ä–µ–µ —á–µ–º –ø—Ä–æ–∫—Å–∏)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –≥–æ—Ç–æ–≤—ã

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π IBEAM –Ω–∞—Å—Ç—Ä–æ–µ–Ω
2. üîÑ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. üìã –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
4. üß™ –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã —Å –º–æ–∫–∞–º–∏
5. üìä –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

**–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª:** Cascade AI  
**–î–∞—Ç–∞:** 23 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
